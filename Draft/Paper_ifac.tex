\documentclass{ifacconf}

\usepackage{natbib}
\usepackage{graphicx}     
\usepackage{xcolor}
\usepackage[utf8]{inputenc}
\usepackage{enumerate}
\usepackage{svg}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage[hidelinks]{hyperref}
\usepackage{svg}
\usepackage{subcaption}
\input{math_commands}  

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
\newtheorem{assumption}{Assumption}
\newtheorem{remark}{Remark}
\newtheorem{problem}{Problem}
\newtheorem{example}{Example}
\newtheorem{property}{Property}



\newcommand{\bphi}{\pmb{\phi}}



\begin{document}
	\begin{frontmatter}
		
		\title{Noninvasive dynamic output-feedback stabilization of multistable systems} 
		% Title, preferably not more than 10 words.
		
		\thanks[footnoteinfo]{This research is carried out by the infinite utility of $k$-contraction}
		
		\author[First]{Samuele Zoboli} 		
        \author[Second]{Andreu Cecilia}
	\author[First]{Sophie Tarbouriech}
 
		\address[Second]{Universitat Polit\`ecnica de Catalunya, Avinguda Diagonal, 647, 08028 Barcelona, Spain, (e-mail: andreu.cecilia@upc.edu)}
  \address[First]{LAAS-CNRS, Universit\'e de Toulouse, CNRS, Toulouse, (e-mail: samuele.zoboli@laas.fr, sophie.tarbouriech@laas.fr)}
		
		\begin{abstract}                % Abstract of not more than 250 words.
   Artificial intelligence, machine learning, engaging keywords.
		\end{abstract}
		
		\begin{keyword}
			LMI, Controller design, Matrix inertia, Nonlinear systems, Contraction, $k$-contraction.
		\end{keyword}
		
	\end{frontmatter}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
{\color{red} To be written}

\medskip
\emph{Notation:}  $\RR_{\geq0}\defeq[0,\infty)$ and
$\NN \defeq \{0,1,2,\ldots\}$. $|\cdot|$ denotes the standard Euclidean norm.
Given $x\in \RR^n$, $y\in \RR^m$, we set 
$(x,y)\defeq (x^\top , y^\top)^\top$.
The inertia of a matrix $P$ 
is defined by the triplet of integers
$
\cine(P) \defeq (\pi_{-}(P),  \pi_{0}(P), \pi_{+}(P)),
$
where $\pi_{-}({P})$, $\pi_{+}(P)$ and $\pi_{0}(P)$ denote the numbers of eigenvalues of $P$ with negative,
positive and zero real part, respectively, counting multiplicities. 



\section{Problem formulation}
We consider nonlinear systems of the form
\begin{equation}\label{eqn:original_system}
\begin{aligned}
\dot x &=   A x  + D\phi(Ex) + Bu,  \\
 y&= Cx+ G\phi(Ex),
\end{aligned}
\end{equation}
where $x\in\RR^{n_x}$ is the state vector,  $u\in\RR^{n_u}$ the controlled input, $y\in\RR^{n_y}$ the measured outputs and $\phi:\RR^{n_v}\to\RR^{n_v}$ is a sufficiently smooth vector field. Additionally, to recover efficiently solvable conditions, we assume the existence of known matrices $R=R^\top, Q=Q^\top$ and $S$ such that 
\begin{equation}\label{eqn:generic_abstraction}
    \pmx{\Id_{n_x}\\\pderiv{\phi}{x}(v)}^\top\pmx{R&S^\top\\S&Q}\pmx{\Id_{n_x}\\\pderiv{\phi}{x}(v)}\preceq 0 
\end{equation}
holds for all $v\in\cV\subseteq \RR^{n_v}$ where $\cV\defeq\{v\in\RR^{n_v}:v=E x, x\in\cX\subseteq \RR^{n_x}\}$. We recall that such a class of nonlinearities includes common and interesting family of functions, such as (shifted) monotonic and differentially sector-bounded ones \citep{zoboli2024quadratic}. 
Finally, we assume that in the unforced case, namely when $u=0$, system \eqref{eqn:original_system} presents a set of fixed points $\cF_x^\star$. More formally, we assume the existence of a nonempty set of equilibria
\begin{equation}\label{eqn:eq_points}
 \cF_x^\star := \{x\in\RR^{n_x} \ | \ Ax+D\phi(E x)= 0\}.
\end{equation}
We highlight that $\cF^\star$ can include multiple elements, that is, system \eqref{eqn:original_system}  may present multiple equilibrium points for the unforced case $u=0$. 

We aim to design a feedback control policy that makes (at least) one point $x^\star\in\cF_x^\star$ asymptotically stable. In other words, we want to make the set $\cF_x^\star$ attractive and forward-invariant. 

One possibility is to reformulate the problem as a standard stabilization one, see e.g. \citep{isidori2017stabilization}. Differently put, the problem could be solved by selecting a specific point  $x^\star\in\cF_x^\star$ and designing a control law making $x^\star$ globally asymptotically stable. However, we highlight that the considered problem relaxes the more common stabilization problem in three directions. First, the goal is not to stabilize the system at a specific point in $\cF_x^\star$, we only need the system to converge to $\cF_x^\star$. Second, the proposed objective allows for the existence of multiple attractive equilibrium points for the closed-loop system.  Third, the set of equilibrium points $\cF_x^\star$ may be unknown to the designer. This third point is particularly relevant for feedback policies that include an integral action, e.g. \citep{Astolfi2017,GIACCAGLI2023111106}, which often require an unknown non-zero steady-state control signal to be generated by the integral component.
Another possibility is to invoke set-stability approaches, e.g. \citep{SHIRIAEV20001709}. However, we remark that $\cF_x^\star$ may be disconnected. Moreover, its elements are given by the (possibly unknown) equilibria of the unforced system dynamics. These facts impose additional restrictions that can impact the effectiveness and applicability of set-stability approaches. 

Given the abovementioned constraints, in what follows, we present a solution that does not require knowledge of the open-loop equilibria and guarantees their stability via $2$-contraction \citep{Michael1995}. Our approach is based on the recent findings in \citep{ cecilia2023generalized, zoboli2024dynamic} and inspired by the techniques of derivative control and washout filters.



\section{Main result}
\subsection{Proposed approach}
We start by highlighting a necessary property controllers must satisfy to guarantee the open-loop equilibria are preserved by the closed loop.
From \eqref{eqn:original_system}, it is clear that for the closed-loop system to stabilize at  $x^\star\in\cF_x^\star$ the control input must vanish at such point.
% dynamic output-feedback law $u=\alpha(y,\xi)$ with state $\xi\in\RR^{n_\xi}$ must satisfy 
% \begin{equation}\label{eqn:noninvasive_cond}
% \alpha(Cx^\star+G\phi(Ex^\star),\xi^\star) = 0, \qquad \forall x^\star \in \cF^\star,
% \end{equation}
% where $\xi^\star$ is the equilibrium state of the controller corresponding to $x^\star$.
We will denote a control policy that satisfies such a property as \textit{noninvasive}, e.g. \citep{ANGELI2024152}. 
\begin{definition}[Noninvasive controller]
Consider the nonlinear system 
\[
\dot x = f(x,u), \qquad y =h(x),
\]
with $x\in\RR^{n_x}, y\in\RR^{n_y}$ and $u\in\RR^{n_u}$. Let 
\[
\cF^\star\defeq\{x\in\RR^{n_x}:f(x,0)=0\}.
\]
The dynamic output-feedback law $u=\alpha(y,\xi)$  with state $\xi\in\RR^{n_\xi}$ is said to be \textit{ noninvasive} if 
\begin{equation}\label{eqn:noninvasive_cond}
\alpha(h(x^\star),\xi^\star) = 0, \qquad \forall x^\star \in \cF^\star,
\end{equation}
where $\xi^\star$ is the controller equilibrium associated to $x^\star$.
\end{definition}

In this paper, we propose ensuring such a requirement via integral action. More specifically, we extend the dynamics of \eqref{eqn:original_system} as follows
\begin{equation}\label{eqn:extended_dyn}
\begin{aligned}
\pmx{\dot x\\ \dot z}&= \pmx{A & 0\\0&0} \pmx{x\\ z} + \pmx{B\\\Id_{n_u}} u + \pmx{D\\0} \phi\left(\pmx{E&0} \pmx{x\\ z} \right),  \\
 \pmx{y\\z}&= \pmx{C & 0\\0 & \Id_{n_u}}\pmx{x\\ z} + \pmx{G\\0} \phi\left(\pmx{E&0}\pmx{x\\ z} \right).
\end{aligned}
\end{equation}
At any equilibrium point $(x^\star,z^\star)$ the $z$-dynamics impose $u=0$, and thus $x^\star \in \cF_x^\star$. 

\subsection{Controller design}
Given the above discussion, we aim to design a dynamic-output feedback controller stabilizing the extended dynamics \eqref{eqn:extended_dyn} to a (possibly nonunique) equilibrium. Moreover, we leverage 2-contraction to obtain local exponential stability of equilibria \citep{Muldowney1990}. In particular, we exploit the techniques of \citep{zoboli2024dynamic} to efficiently design a noninvasive linear dynamic output-feedback controller guaranteeing 2-contractivity of the extended closed loop. More formally, we select $n_\xi = n_x+n_u$ and we consider the extended system
\begin{equation}
\begin{array}{rl}
        \label{eqn:nonlin_sys_ctrl}
        \dot x &=  A x +  D\phi(Ex) + Bu, \\
        y&= Cx + G\phi(Ex),\\
        \dot z &= u,\\
        \dot \xi &= M\xi + N y + Fz,\\
        u&=K y + L\xi + Hz,
    \end{array}
\end{equation}
which can be equivalently represented as
\begin{subequations}
\begin{equation}
\begin{array}{rl}
        \label{eqn:nonlin_sys_closed_loop}
        \dot \eta= f(\eta)=\bA \eta + \bD\phi(\bE\eta)
    \end{array}
\end{equation}
with $\eta = \col(x,z,\xi)\in\RR^{n_\eta}$, $n_\eta = n_x+n_u+n_\xi = 2n_\xi$ and
\begin{equation}
\begin{array}{rl}
        \label{eqn:nonlin_sys_closed_loop_matrices}
        % \bA&= \pmx{\smallpmat{A & 0 \\ 0& 0}+\smallpmat{B\\\Id_{n_z}}K\smallpmat{C & F} & \smallpmat{B\\\Id_{n_z}}L\\ N\smallpmat{C & F} & M},  \\
        %  \bD &= \pmx{D_e  + \smallpmat{B\\\Id_{n_z}}KG \\ NG}, \quad
        %  \bE = \pmx{E & 0 & 0}.
        %  \\
          \bA&= \pmx{A+BKC & BH & BL\\
          KC & H & L\\
          NC & F & M},  \\
         \bD &= \pmx{D+BKG\\KG\\NG}, \quad
         \bE = \pmx{E & 0 & 0}.
    \end{array}
\end{equation}
\end{subequations}
We also remark that \eqref{eqn:generic_abstraction} implies the existence of matrices $\bR,\bS,\bQ$ such that
\begin{equation}\label{eqn:generic_abstraction_ctrl}
    \pmx{\Id_{n_\eta}\\\pderiv{\phi}{\eta}(\bE\eta)}^\top\pmx{\bR&\bS^\top\\\bS&\bQ}\pmx{\Id_{n_\eta}\\\pderiv{\phi}{\eta}(\bE\eta)}\preceq 0
\end{equation}
holds for all $\eta\in\cS\subseteq \RR^{n_\eta}$ with $\cS\defeq\{\eta\RR^{n_\eta}: \bE\eta\in\cV\}$, see \citep[Section 2.5]{zoboli2024dynamic}. 
The following result proposes a design for noninvasive linear dynamic output-feedback controllers based on matrix inequalities.
\begin{figure*}
    \begin{equation}\label{eqn:2_contraction_BMI}
    \begin{array}{rl}
      A_e&\defeq \pmx{A&0\\0&0},\qquad  B_e \defeq \pmx{B\\\Id_{n_u}},\qquad C_e \defeq \pmx{C&0\\0&\Id_{n_u}},\qquad 
    D_e \defeq  \pmx{D\\0}, \qquad G_e \defeq  \pmx{G\\0}, \quad 
        \Phi \defeq \pmx{\Pi_2 & \Id_{n_\xi}\\ \Id_{n_\xi} & \Pi_1},
     \\&\\
        \widehat A &\defeq\pmx{A_e\Pi_2+B_e \widehat L && A_e + B_e  \widehat K C_e \\ \widehat M && \Pi_1 A_e+ \widehat N  C_e }, \quad  
        \widehat D \defeq \pmx{D_e +B_e \widehat K G_e\\ \Pi_1 D_e  + \widehat N G_e}, 
        \quad  \widehat R \defeq \pmx{ \widehat R_{11} &  \widehat R_{12}^\top\\
        \star & \widehat R_{22}}, \quad \widehat S^\top \defeq \pmx{\widehat S_1^\top \\ \widehat S_2^\top},
        \\&\\
        &
        \pmx{\widehat R_{11} - \overbar R& \widehat R_{12}^\top - \alpha \Pi_2 R^\top & \widehat S_{1}^\top-\alpha \Pi_2 S^\top\\
         \star & \widehat R_{22}-\alpha R & \widehat S_{2}^\top -\alpha S^\top \\
         \star&\star& \widehat Q-\alpha Q} +
         \He{\pmx{\Upsilon_1\\\Upsilon_2\\\Upsilon_3}\pmx{\pderiv{\phi}{x}(v)& 0 & -\Id_{n_x}}}\preceq 0 , \qquad \forall v \in \cV,
        \\&\\
           & \pmx{
   \He{A_e \Pi_2+B_e \widehat L} -2\beta_1 \Pi_2 - \widehat R_{11} && A_e+B_e \widehat K C_e  + \widehat M^\top-2\beta_1 \Id_{n_\xi} -  \widehat R_{12}^\top && D_e +B_e \widehat K G_e -  \widehat S_1^\top\\
   \star && \He{ \Pi_1 A_e +  \widehat N  C_e } -2\beta_1 \Pi_1   -\widehat R_{22}&& \Pi_1 D_e  + \widehat N G_e -\widehat S_2\\
   \star &&\star&& - \widehat Q
    }\prec 0,\\&\\
         &\pmx{
    -2\beta_0 \Sigma+ \He{\Gamma_1 \widehat A} - \widehat R & & \Sigma- \Gamma_1 \Phi+ \widehat A^\top \Gamma_2^\top  &  &\Gamma_1 \widehat D +  \widehat A^\top \Gamma_3^\top - \widehat S^\top\\
    \star  && -\He{\Gamma_2 \Phi}  & &\Gamma_2 \widehat D -\Phi\Gamma_3^\top \\
    \star && \star& &\He{\Gamma_3 \widehat D} - \widehat Q
    }\prec 0  .\\&\\
    \end{array}    
    \end{equation}
    \hrule
\end{figure*}
\begin{proposition}
    \label{prp:2_contr_BMI}
     Consider  \eqref{eqn:nonlin_sys_closed_loop} with \eqref{eqn:nonlin_sys_closed_loop_matrices} %\eqref{eqn:closed_loop}
and let \eqref{eqn:generic_abstraction_ctrl} hold for all  $x\in\cF$  with given matrices $R, S, Q$. Select $Z\preceq 0$ such that $Z\preceq R$ and assume there exist $ \overbar R_{11}=\overbar R^\top,$ $ \widehat R_{11}=\widehat R_{11}^\top,$ $ \widehat R_{12},$ $ \widehat R_{22}=\widehat R_{22}^\top,$ $ \widehat S_1,$ $ \widehat S_2,$ $ \widehat Q=\widehat Q^\top,$ scalars $\alpha>0,\beta_0\in\RR$, $\beta_1<0$,  symmetric matrices $\Pi_1=\Pi_1^\top, \Pi_2=\Pi_2^\top \in \RR^{n_\xi\times n_\xi}$, matrices $\widehat K \in \RR^{n_u\times n_y}$, $\widehat L\in \RR^{n_u\times n_\xi}$, $\widehat M\in \RR^{n_\xi\times n_\xi}$, $\widehat N \in \RR^{n_\xi\times n_\xi}$,  matrices $\Gamma_1, \Gamma_2, \Gamma_3$  and $\Sigma=\Sigma^\top\succ 0$  such that 
\begin{enumerate}[i)]
        \item The matrix $ R_Z \defeq \smallpmat{\overbar R && \alpha \Pi_2Z\\ \star && \alpha Z}$ is negative semidefinite;
         \item Inequality \eqref{eqn:2_contraction_BMI}\footnotemark[1] holds with $\beta_0+\beta_1<0$;
        \item $\cine(\Gamma_2)=(1, 0, 2n_\xi-1)$.
    \end{enumerate}
    \footnotetext[1]{Given at the top of the next page.}
     Then, 
     there exist square invertible matrices $U,V\in \RR^{n_\xi\times n_\xi}$ such that $UV^\top = \Id_{n_\xi}- \Pi_1\Pi_2$
    and a scalar $\Delta^\star>0$ such that the control matrices 
    \begin{equation}
    \label{eqn:ctrl_matrices}
    \begin{array}{rl}
          \pmx{K & H}&= \widehat K,  \\
         \pmx{N& F}&= U^{-1} (\widehat N - \Pi_1 B \widehat K) ,\\
           L & = (\widehat L - \widehat K C \Pi_2) V^{-\top},\\
         M&=U^{-1}\!\pmx{\Id_{n_\xi}\\-\Pi_1}^{\!\top}\!\!\pmx{\widehat M & \widehat N C\\
         B \widehat L & -A+ B\widehat  KC}\pmx{\Id_{n_\xi}\\-\Pi_2}V^{-\top}\!\!\!\!\!\!
    \end{array}
\end{equation}
    ensure all trajectories of any perturbed closed loop
\begin{equation}
\begin{array}{rl}
        \label{eqn:nonlin_sys_closed_loop_pert}
        \dot \eta= \widetilde f(\eta) =\bA \eta + \bD\phi(\bE\eta)+ \delta(\eta)
    \end{array}
\end{equation} 
evolving in a forward-invariant bounded compact set $\cK\subseteq\cS$ with  $\delta(\eta)=\col(\delta_x(\eta),0,0)$,  $\delta_x(\eta)\in \cC^1$, $|\pderiv{\delta_x}{\eta}(\eta)|<\Delta^\star$  for all $\eta \in \cK$,
converge to an equilibrium $\eta^\star\in \cF^\star_\eta$ with
    \begin{equation}
        \label{eqn:closed_loop_eq_set}
        \cF^\star_\eta \defeq \{\eta\in\cK: Ax+D\phi(E x) + \delta_x(x)= 0\}.
    \end{equation}
\end{proposition}
The proof of Proposition~\ref{prp:2_contr_BMI} is presented in Section~\ref{sec:proof_prp1}.

Controllers issued from Proposition~\ref{prp:2_contr_BMI} ensure convergence of the closed-loop trajectories to open-loop equilibria  even in the presence of (sufficiently slow-varying) state-dependent uncertainties. This robust noninvasive behavior differs from the one in \citep{ANGELI2024152}, where the open-loop dynamics must be perfectly known, or the derivative of the state must be measurable.  Moreover, while the matrices $R,S,Q$ in \eqref{eqn:generic_abstraction} (and therefore $\bR,\bS,\bQ$ in \eqref{eqn:generic_abstraction_ctrl}) are assumed to be known, extensions of Proposition~\ref{prp:2_contr_BMI} to cases of unknown quadratic abstractions can be proposed by following the results in \citep[Section 2]{zoboli2024dynamic}. 

Nonetheless, Proposition~\ref{prp:2_contr_BMI} presents two main drawbacks. Firstly, it requires imposing matrix inertia constraints, see item iii). A detailed discussion on methods to impose such constraints in the optimization problem is presented in \citep[Section 3]{zoboli2024dynamic}. Secondly, it requires closed-loop trajectories to evolve in a forward invariant bounded compact set $\cK$. This necessity arises from the fact that the proposed result is grounded on the notion of $2$-contraction, which guarantees convergence to nonunique equilibria if the system evolves in forward invariant bounded compact sets \citep[Theorem 2.5]{Michael1995}, \citep[Lemma 6]{cecilia2023generalized}. Therefore, we now present an LMI-based approach allowing the \textit{a-posteriori} verification of such a requirement.

\begin{figure*}
    \begin{equation}
    \label{eqn:ellipsoid_LMI}
    \pmx{\tau_1 P_{\cE_1}- \tau_2 P_{\cE_2} + \bA_s^\top P_{\cE_1} + P_{\cE_1} \bA_s - \bX && P_{\cE_1}  -\bY^\top && 0\\\star && - \bZ&&0\\
    \star && \star  && -\tau_1 + \tau_2 }\prec 0.
\end{equation}
    \vspace{.5em}
\hrule
\end{figure*}
\begin{proposition}\label{prp:invariant_set}
    Consider \eqref{eqn:nonlin_sys_closed_loop} and let $\bA = \bA_s +\widetilde \bA$ with $\bA_s$ Hurwitz. Suppose there exist matrices $\bX=\bX^\top$, $\bY$, $\bZ=\bZ^\top$, a set $\cS\subseteq\RR^{n_\eta}$ and a vector $\eta^\star\in\cS$ such that the local sector condition
    \begin{equation}
        \label{eqn:local_sect_eta_reshaped}
        \pmx{\eta - \eta^\star\\ \psi(\bE\eta)-\psi(\bE\eta^\star)}^\top\pmx{\bX &\bY^\top\\\bY&\bZ}\pmx{\eta - \eta^\star\\ \psi(\bE\eta)-\psi(\bE\eta^\star)}\le 0
    \end{equation}
    holds for all $\eta\in\cS$, with $\psi(v)\defeq \bD \phi(v)+\widetilde \bA\eta$. 
    If there exist positive scalars $\tau_1$, $\tau_2$, two matrices $P_{\cE_1}\succeq P_{\cE_2}\succ 0$ and a matrix $\Omega\in\RR^{n_\eta \times n_u}$ such that \eqref{eqn:ellipsoid_LMI}\footnotemark[2] holds and such that the ellipsoidal set $\cE_2\defeq\{\eta\in\RR^{n_\eta}:(\eta-\eta^\star)^\top P_{\cE_2} (\eta-\eta^\star) \le 1\} \subseteq\cS$, then $\cE_1\defeq\{\eta\in\RR^{n_\eta}:(\eta-\eta^\star)^\top P_{\cE_1} (\eta-\eta^\star) \le 1\}$ is  attractive and forward invariant for \eqref{eqn:nonlin_sys_closed_loop} with region of attraction including the  non-empty set $\widetilde\cE\defeq \cE_2\setminus\cE_1$, for all $\eta\in \cS$.
\end{proposition}
The proof of Proposition~\ref{prp:invariant_set} is presented in Section~\ref{sec:proof_prp2}. 
\footnotetext[2]{Given at the top of the next page.}

\begin{remark}
    Note that the loop transformation $\bA=\bA_s+\widetilde \bA$,  $\psi(v)\defeq \bD \phi(v)+\widetilde \bA\eta$ is a necessary step for the satisfaction of \eqref{eqn:ellipsoid_LMI}. Indeed, after the removal of the quadratic abstraction entry $\bX$, the top-left entry of \eqref{eqn:ellipsoid_LMI} requires
    \[
    \tau_1 P_{\cE_1}- \tau_2 P_{\cE_2} + \bA_s^\top P_{\cE_1} + P_{\cE_1} \bA_s \prec 0.
    \]
    Since $P_{\cE_1}\succeq P_{\cE_2}$ this implies
    \[
    (\tau_1-\tau_2) P_{\cE_1} + \bA_s^\top P_{\cE_1} + P_{\cE_1} \bA_s \prec 0,
    \]
    which requires $\bA_s$ Hurwitz, given that $\tau_1>\tau_2$ from the bottom-right entry of \eqref{eqn:ellipsoid_LMI}. Moreover, since the pair $(\bA, \bD)$ may not be controllable, the more classical loop transformation involving the addition and subtraction of a virtual stabilizing input $u_s = \bK\eta$ and the definition of a reshaped nonlinearity $\psi(v)=\phi(v) - \bK \eta$ may not be applicable. Thus, $\psi(v)$ must include $\bD$ in its definition.
\end{remark}
%
While useful, the results of Proposition~\ref{prp:invariant_set} present two main drawbacks. First, they require the knowledge of a nondifferential quadratic abstraction \eqref{eqn:local_sect_eta_reshaped} for the \emph{reshaped closed loop}. Second, they do not guarantee the outer ellipsoid $\cE_2\subseteq\cS$. We first address the issues emerging from the loop transformation by proposing a result connecting quadratic abstractions on the original system to ones on the reshaped loop.
\begin{lemma}\label{lem:orig2reshaped_abs}
    Consider \eqref{eqn:nonlin_sys_closed_loop} and suppose there exist matrices $X=X$, $Y$, $Z=Z$, a set $\cS\subseteq\RR^{n_\eta}$ and a vector $\eta^\star\in\cS$ such that the local sector condition
    \begin{equation}
        \label{eqn:local_sect_eta}
        \pmx{\eta - \eta^\star\\ \phi(\bE\eta)-\phi(\bE\eta^\star)}^\top\pmx{X &Y^\top\\Y&Z}\pmx{\eta - \eta^\star\\ \phi(\bE\eta)-\phi(\bE\eta^\star)}\le 0
    \end{equation}
    holds for all $\eta\in\cS$. If there exists a matrix $\Omega\in\RR^{n_\eta\times n_v}$ such that
        \begin{equation}
    \label{eqn:D_full}
    \pmx{\bD^\top \Omega + \Omega^\top \bD && \Omega^\top\\
    \star && \Id_{n_u}}\succ 0,
\end{equation}
then $\bD^\top\bD\succ 0$ and \eqref{eqn:local_sect_eta_reshaped} holds with
\begin{equation}
    \label{eqn:original2reshaped_abs_matrices}
    \begin{array}{rl}
        \overbar \bD &= (\bD^\top \bD)^{-1}\bD^\top,\\
         \bX &= X- Y^\top \overbar \bD\widetilde \bA - \widetilde \bA^\top  \overbar \bD^\top Y - \widetilde \bA^\top \overbar \bD^\top Z \overbar \bD\widetilde \bA,\\
         \bY &= \overbar \bD Y + \overbar \bD^\top Z \overbar \bD\widetilde \bA,\\
         \bZ &= \overbar \bD^\top Z \overbar \bD.
    \end{array}
\end{equation}
\end{lemma}
The proof of Lemma~\ref{lem:orig2reshaped_abs} is presented in Section~\ref{sec:proof_lem1}.

Lemma~\ref{lem:orig2reshaped_abs} allows translating quadratic abstractions for the original closed loop to abstractions for the transformed one. We highlight that constraint \eqref{eqn:D_full} can be dropped by assuming $\bD$ has full column rank. 

While representing an important step in improving the applicability of
Proposition~\ref{prp:invariant_set}, Lemma~\ref{lem:orig2reshaped_abs} requires knowledge of matrices $X,Y,Z$ in \eqref{eqn:local_sect_eta} and it does not guarantee the outer ellipsoid $\cE_2\subseteq\cS$.
One possible workaround to both issues is to exploit the knowledge of the differential abstraction \eqref{eqn:generic_abstraction} to derive a global incremental one. This is formalized in the following lemma.
\begin{lemma}
    \label{lem:diff2incr_abstraction}
    If there exist matrices $R_v,S_v, Q_v$ with $Q_v\succ 0$ such that $\phi:\RR^{n_v}\to\RR^{n_v}$ satisfies
    \begin{equation}\label{eqn:diff_abstr}
    \pmx{\Id_{n_v}\\\pderiv{\phi}{v}(v)}^\top\pmx{R_v&S_v^\top\\S_v&Q_v}\pmx{\Id_{n_v}\\\pderiv{\phi}{v}(v)}\preceq 0,
    \end{equation}
    for all $v\in \RR^{n_v}$, then 
    \begin{equation}\label{eqn:incr_abstr}
        \pmx{v_1-v_2\\\phi(v_1)-\phi(v_2)}^\top\pmx{R_v&S_v^\top\\S_v&Q_v}\pmx{v_1-v_2\\\phi(v_1)-\phi(v_2)}\preceq 0,
    \end{equation}
    holds for all $v_1,v_2\in\RR^{n_v}$.
\end{lemma}
The proof of Lemma~\ref{lem:diff2incr_abstraction} is presented in Section~\ref{sec:proof_lem2}.

Given the relation $v=Ex=\bE\eta$, Lemma~\ref{lem:diff2incr_abstraction} shows that one can select $X = \gamma\bR = \gamma \bE^\top R_v \bE$, $Y=\gamma \bS = \gamma \bE S_v$ and $Z=\gamma \bQ = \gamma Q_v$ in \eqref{eqn:ellipsoid_LMI} for any $\gamma>0$, see for instance \citep[Section 2.5]{zoboli2024dynamic}. Indeed, since \eqref{eqn:incr_abstr} holds for all $v_1,v_2$, it holds also for $v_2=\bE\eta^\star$ and obtain $\cS=\RR^{n_\eta}$ in Proposition~\ref{prp:invariant_set}, ensuring $\cE_2\subseteq\cS$. Then, Lemma~\ref{lem:orig2reshaped_abs} allows mapping the obtained abstraction to \eqref{eqn:local_sect_eta_reshaped}. Given \eqref{eqn:original2reshaped_abs_matrices}, the requirement of $Q_v\succ0$ does not restrict the set of solutions to the LMI, as the central block of \eqref{eqn:ellipsoid_LMI} imposes the same constraint in the form $\bZ\succ 0$.

Unfortunately, the exploitation of Lemma~\ref{lem:diff2incr_abstraction} is very conservative and still presents drawbacks. Importantly, \eqref{eqn:incr_abstr} holds for any pair $v_1,v_2$. As such, the resulting abstraction represents an incremental sector condition rather than a local one as per \eqref{eqn:local_sect_eta_reshaped}. Therefore, while holding also for the ellipsoid center $\eta^\star$, it is not specific to such a point. This may lead to increased conservatives and numerical problems since the resulting ellipsoids are not anchored to a specific point, i.e., they could be interpreted as incremental ones.

Given the above discussion, we argue that estimating the matrices $\bX,\bY,\bZ$ given a desired open-loop center $x^\star$ is a more reliable solution. This approach only requires minor knowledge of local sector bounds for the nonlinearity $\phi$. Moreover, it allows including constraints guaranteeing $\cE_2$ is included in the known local sector. We formalize the proposed technique in the following theorem.

\begin{figure*}
    \begin{subequations}
    \label{eqn:local_sector_and_inclusion}
    \begin{equation}
    \label{eqn:original2reshaped_abs_matrices}
    \begin{array}{rl}
         \widehat X &= \bE^\top X_v\bE - \bE^\top Y_v^\top \overbar \bD\widetilde \bA - \widetilde \bA^\top  \overbar \bD^\top Y_v \bE - \widetilde \bA^\top \overbar \bD^\top Z_v \overbar \bD\widetilde \bA,\\
         \widehat Y &= \overbar \bD Y + \overbar \bD^\top Z \overbar \bD\widetilde \bA,\\
         \widehat Z &= \overbar \bD^\top Z \overbar \bD.
    \end{array}
\end{equation}
\begin{align}
    \label{eqn:local_sec_open_loop_polytopic}
    &\pmx{\Id_{n_v}\\\Lambda}^\top\pmx{X_v&Y_v^\top\\Y_v&Z_v}\pmx{\Id_{n_v}\\\Lambda} \preceq 0,  \qquad \forall \Lambda: \Theta_1\preceq \Lambda\preceq\Theta_2\\
    \notag\\
\label{eqn:local_sec_closed_loop_polytopic}
    &\pmx{ 0 && 0 && 0\\
     0 && \bX - \widehat X && \bY^\top - \widehat Y^\top \\
     \0 && \bY - \widehat Y && \bZ- \widehat Z }+\He{\pmx{\Upsilon_1 \\ \Upsilon_2\\
    \Upsilon_3 
    }\pmx{\Id_{n_\eta} & -\bA & \Id_{n_v}}}\preceq 0\\\notag\\
    \label{eqn:ellipsoid_inclusion_polytopic}
    &\pmx{P_{\cE_2} &\bE_i^\top\\ \bE_i & (\overbar v -\underline v)_i^2}\succeq 0, \qquad i=1, \dots, n_v.
\end{align}
\hrule
\end{subequations}
\end{figure*}
\begin{theorem}\label{thm:invariant_ellipsoid_local_sect}
Let $\Theta_1,\Theta_2\in\RR^{n_v\times n_v}$ be given diagonal matrices such that $\Theta_1\preceq\Theta_2$. Assume there exist vectors $\underline v, \overbar v, x^\star$ such that $v^\star = Ex^\star \in[\underline v, \overbar v]$ and
\begin{equation}
    \label{eqn:local_sector_v}
   (\phi(v)-\phi(v^\star) -\Theta_1(v-v^\star))_i
   (\phi(v)-\phi(v^\star) -\Theta_2(v-v^\star))_i\le0
\end{equation}
for all $i=1,\dots,n_v$ and for all $v\in[\underline v, \overbar v]$, where $(\cdot)_i$ represents the $i^{\text{th}}$ element of the argument vector or the $i^{\text{th}}$ row of the argument matrix. If there exist positive scalars $\tau_1$, $\tau_2$, a matrix $\Omega\in\RR^{n_\eta\times n_v}$, two matrices $P_{\cE_1}\succeq P_{\cE_2}\succ 0$, matrices $\Upsilon_i$ with $i=,\dots, 8$  and matrices $X_v=X_v^\top$, $Y_v$, $ Z_v= Z_v^\top$, $\bX=\bX^\top$, $\bY$, $ \bZ= \bZ^\top$ such that \eqref{eqn:ellipsoid_LMI} , \eqref{eqn:D_full}
and \eqref{eqn:local_sector_and_inclusion} hold wit $\overbar \bD$ as in \eqref{eqn:original2reshaped_abs_matrices}, then $\cE_1\defeq\{\eta\in\RR^{n_\eta}:(\eta-\eta^\star)^\top P_{\cE_1} (\eta-\eta^\star) \le 1\}$ is  attractive and forward invariant for \eqref{eqn:nonlin_sys_closed_loop} with region of attraction including the  non-empty set $\widetilde\cE\defeq \cE_2\setminus\cE_1$, with 
${\color{red}\eta^\star=\col(x^\star, 0, 0)}$ and
$\cE_2\defeq\{\eta\in\RR^{n_\eta}:(\eta-\eta^\star)^\top P_{\cE_2} (\eta-\eta^\star) \le 1\}$.
\end{theorem}
The proof of Theorem~\ref{thm:invariant_ellipsoid_local_sect} is presented in Section~\ref{sec:proof_thm1}.

Theorem~\ref{thm:invariant_ellipsoid_local_sect} considers the abstraction matrices $\bX,\bY,\bZ$, $X_v, Y_v, Z_v$ as problem variables. To reduce the size of the optimization problem, one could select $\bX=\widehat X$,  $ \bY =  \widehat Y$  and $\bZ= \widehat Z$, thus removing \eqref{eqn:local_sec_closed_loop_polytopic}. However, the inclusion of \eqref{eqn:local_sec_closed_loop_polytopic} leaves more degrees of freedom to the optimization problem, which can exploit entries in the directions of the integrator and controller states. Under the selection mentioned previously, these entries would be set to $0$ by the structure of $\bE$. We also highlight that \eqref{eqn:local_sec_open_loop_polytopic} is typically hard to solve. However, if we constrain the diagonal elements of $Z_v$ to be nonpositive, it is sufficient to check the condition for all
matrices $\Lambda$ corresponding to the finitely many vertices
of the matrix interval $[\Theta_1,\Theta_2]$ \citep{ebihara2021stability}. This can be easily done b, e.g., decomposing $Z_v\defeq Z_d + \widetilde Z^\top + \widetilde Z$ with diagonal $Z_d\preceq 0$ and lower triangular $\widetilde Z$.

\begin{remark}
    Since the differential quadratic abstraction \eqref{eqn:generic_abstraction} holds for all $v\in\cV$ and given the degree of freedom arising from letting matrices $X_v,Y_v,Z_v$ as decision variables, one can select $\underline v, \overbar v$ and compute $\Theta_1,\Theta_2$ for Theorem~\ref{thm:invariant_ellipsoid_local_sect} such that the resulting polytope is included in $\cV$. This choice connects the regions where 2-contractivity holds and the invariant ellipsoid is looked for.
\end{remark}

\section{Comparison with the literature}\label{sec:comparison_lit}
We highlight that alternative solutions to the considered stabilization problem can be found on the literature. Thus, we find it necessary to discuss the main differences between these results and the proposal of this work.

The main property that characterizes a noninvasive control is that the input signal is zero at steady-state. In this paper, we achieved this property through the noninvasive condition in \eqref{eqn:noninvasive_cond}. An alternative way for obtaining zero steady-state input is to design a feedback policy that uses the derivative of the state, that is $u = \alpha(\dot x)$ with $\alpha(0)=0$. This approach have been explored by some authors under the name of state-derivative feedback \citep{ZAHEER2021109495,Arthur2019} and was generalized to its derivative-output version in \citep{ZAHEER2021109495,ARTHUR202040}. We highlight that these results only provide design conditions for linear systems or linearized systems around a unique equilibrium point. Thus, these approaches have very limited applicability to nonlinear systems with multiple uncertain equilibrium points or with initial conditions far from an equilibrium point. 

Recently, the authors in \citep{ANGELI2024152} applied $2$-contraction theory for designing state-derivative controllers. $2$-contraction enabled the development of non-local design conditions for multistable systems. A similar framework to the one proposed in \citep{ANGELI2024152} can be recovered from \eqref{eqn:original_system} by selecting $C=A, G=D$ and the static control policy $u=Ky$. Nonetheless, the proposal in \citep{ANGELI2024152} is not free of limitations. First, it requires a direct measurement of the derivative of the state or an exact knowledge of the system vector field. Second, the design conditions are based on mathematical objects known as matrix compounds \citep{bar2023compound}, which usually explode in dimension and may destroy advantageous structural properties of the system. 

Our proposal can be understood as an extension of the washout filter discussed in \citep{GARRARD1977497, WANG19951213, Hassouneh2004}. Indeed, we achieve a zero steady-state input by designing the controller as a linear filter with a blocking zero in the origin. Thus, we do not require any measurement of the state or output derivative, and we can operate directly with the system output. 
Nevertheless, we remark that our approach is not free from tradeoffs. Indeed, the addition of input integrators does not allow any of the system's outputs to be regulated. From output regulation theory, the number of regulated outputs must be smaller than or equal to the number of inputs, see e.g. \citep{isidori2003robust}. By adding integrator dynamics on all input signals, such a regulation limit is reached.
We also stress that the addition of input-integrator dynamics may cause the loss of controllability properties. This is shown by the following simple example.
Consider the planar linear time invariant system
\begin{equation}
    \label{eqn:ctrlb_example_sys}
    \begin{array}{rl}
     \dot x_1&= x_1+u  \\
     \dot x_2 &= x_1 
\end{array}
\end{equation}
with $x=\col(x_1,x_2)\in\RR^2$ and $u\in\RR$. It can be easily verified that \eqref{eqn:ctrlb_example_sys} is controllable. However, by adding the input-integrator dynamics, the resulting extended system
\[
    \begin{array}{rl}
     \dot x_1&= x_1+u  \\
     \dot x_2 &= x_1 \\
     \dot z &= u,
\end{array}
\]
has a simply stable uncontrollable mode. However, the $2$-contraction framework proposed in this paper only requires a generalized notion of stabilizability properties \citep{cecilia2023generalized}.
We also highlight that, different from previous results with washout filter, the combination of $2$-contraction \citep{cecilia2023generalized} with the design conditions provided in \citep{zoboli2024dynamic} provides for the first time LMI design conditions for the proposed stabilization problem which are:
\begin{itemize}
    \item non-local (in the sense that the state can be initialized far from any equilibrium point);
    \item can be implemented in nonlinear systems with multiple equilibria;
    \item can be implemented just with the system output.
\end{itemize}


\section{Numerical simulation}
As an illustration of the proposed we consider a second order system of the form \eqref{eqn:original_system} with the following matrices
$$
\begin{aligned}
    A = \begin{bmatrix}
        0 & 1\\ 0 & 0
    \end{bmatrix}, \ B = \begin{bmatrix}
        0 \\ 1
    \end{bmatrix}, \ D = \begin{bmatrix}
        0 \\ 1
    \end{bmatrix}, \ C = E= \begin{bmatrix}
        1 & 0
    \end{bmatrix}, G = 1
\end{aligned}
$$
and the following nonlinearity:
$$
\phi(v)=\cos(v+\theta),
$$
where $\theta\in\RR$ is a constant unknown by the designer. For this particular system, defining $x_1$ and $x_2$ and $x = \begin{bmatrix}
    x_1 & x_2
\end{bmatrix}^\top$, we have the following set of equilibrium points:
$$
\cF^\star = \{x\in\RR^2 \ | \ \cos(x_1+\theta)=0, \ x_2 = 0\}.
$$
In the unforced case $u=0$, the considered system can be understood as a frictionless pendulum with $x_1$ being the pendulum angle shifted by $\theta$ and $x_2$ is the angular velocity. Therefore, the set $\cF^\star$ is not attractive and for any initial condition outside $\cF^\star$ the system converges to a non-trivial limit cycle. With this in mind, the objective is to make the set $\cF^\star$ attractive and invariant.

We highlight that the proposed stabilization problem can be trivially solved using the state-derivative feedback discussed in Section~\ref{sec:comparison_lit}. Indeed, any feedback term of the form $u = -\kappa x_2$, with a sufficiently large $\kappa>0$, would solve the considered stabilization problem, since at any equilibrium we have $x_2 = 0$. Nonetheless, we highlight that we have no direct measure of the states or its derivative, only of the signal $y = x_1 + \cos(x_1+\theta)$. Thus, the state derivative feedback methodology cannot be directly implemented. Naturally, one could try to design an observer for the system and then use the estimation of the second state, denoted $\hat x_2$, as the state derivative feedback, that is  $u = -\kappa \hat x_2$. Nonetheless, the design of such an observer is not trivial due to the unknown constant $\theta$. If one tries to, somehow, design an observer robust to the unknown parameter $\theta$, it will significantly increase the noise sensitivity of the feedback policy. Additionally, the extended system:
$$
\begin{aligned}
    \dot x_1 &= x_2 \\
    \dot x_2 &= \cos(x_2+x_3) + u \\
    \dot x_3 &= 0 \\
    y &= x_1 + \cos(x_1+x_3)
\end{aligned}
$$
is not observable at any equilibrium point with $u=0$, since we have $\dot y = 0$ and $y = x_1 + \cos(x_1+x_3) = x_1 + \cos(x_1+n x_3)$ for any positive and odd integer $n$. Thus, the design of an observer that jointly estimates the states $x$ and the unknown parameter $\theta$ is not a trivial task if we impose a zero steady-state input. Considering these difficulties, the purpose of this section is to show how the problem can be directly solved with the framework proposed in this work.

Controller:
\begin{equation*}
\begin{aligned}
    M &= \smallbmat{
        0.29 &  -2.04  &  1.45\\
   -2.04 &  -3.34 &  -0.97\\
    1.45 &  -0.97  &  1.23},  &N &= \smallbmat{
        -13.91  & -0.17\\
   -3.45  & -1.42 \\
   10.52 &  -4.3}, \\
    K &= \smallbmat{
        -3.77 &  -4.38},  
    &L &= \smallbmat{
        -16.02 &  -0.68 & -13.8},
\end{aligned}
\end{equation*}




\begin{figure}
\includesvg[width=1\linewidth]{Figures/closed-loop}
 \caption{Constant theta case, closed loop}
         \label{fig:constant_theta}
\end{figure}


\begin{figure*}
	\centering
	\begin{subfigure}{0.42\linewidth}
		\includesvg[width=\linewidth]{Figures/open_loop_theta_change}
	\end{subfigure}
	\begin{subfigure}{0.42\linewidth}
		\includesvg[width=\linewidth]{Figures/closed_loop_theta_change}
	\end{subfigure}
 \begin{subfigure}{0.42\linewidth}
		\includesvg[width=\linewidth]{Figures/closed_loop_theta_change_zoom}
	\end{subfigure}
 \caption{Open-loop and closed-loop with no noise and noise (variance $0.05$.)}
         \label{fig:theta_change}
\end{figure*}

\section{Proofs}
\subsection{Proof of Proposition~\ref{prp:2_contr_BMI}}\label{sec:proof_prp1}
Note that the extended matrices $A_e, B_e, C_e, D_e, G_e$ in \eqref{eqn:2_contraction_BMI} describe the $(x,z)$-dynamics in \eqref{eqn:extended_dyn}. Therefore, by \citep[Theorem 2]{zoboli2024dynamic} adapted with the result on known quadratic abstraction of \citep[Corollary 2]{zoboli2024dynamic}, the matrix inequalities in \eqref{eqn:2_contraction_BMI} paired with items i)-iii) of Proposition~\ref{prp:2_contr_BMI} guarantee $\cine(\Sigma_1)=(1,0,2n_\eta-1)$ and
\begin{equation}
\label{eqn:2_contr_cond_closed_loop}
\begin{cases}
     \left( \bA+ \bD\pderiv{\phi}{\eta}(\bE\eta) \right)^\top P_0 +  P_0 \left(\bA+ \bD\pderiv{\phi}{\eta}(\bE\eta) \right) \prec 2\mu_0 P_0,\\
     \left( \bA+ \bD\pderiv{\phi}{\eta}(\bE\eta) \right)^\top P_1 +  P_1 \left(\bA+ \bD\pderiv{\phi}{\eta}(\bE\eta) \right) \prec 2\mu_1 P_1,\\
     \mu_0+\mu_1<0
\end{cases}
\end{equation}
for all $\eta\in\cK$ with $P_0=\Sigma_0, P_1=\Sigma_1, \beta_0=\mu_0,\beta_1=\mu_1$. 
Since $\cK$ is bounded and compact, there exist strictly positive scalars $\varepsilon_0,\varepsilon_1$ such that
\[
\begin{cases}
    \pderiv{ f}{\eta}(\eta)^\top P_0 +  P_0 \pderiv{ f}{\eta}(\eta) \preceq 2\mu_0 P_0 - \varepsilon_0 \Id_{n_\eta},\\
    \pderiv{ f}{\eta}(\eta)^\top P_1 +  P_1 \pderiv{ f}{\eta}(\eta)\preceq 2\mu_1 P_1 - \varepsilon_1 \Id_{n_\eta},\\
     \mu_0+\mu_1<0.
\end{cases}
\]
Note that $|\pderiv{\delta}{\eta}(\eta)|=|\pderiv{\delta_x}{\eta}(\eta)|$ for all $\eta \in \cK$. By \citep[Lemma 8]{zoboli2024dynamic} and the relative proof, there exist strictly positive $\gamma_0,\gamma_1$ small enough and $\Delta^\star_0\in (0,\varepsilon_0\gamma_0),\,  \Delta^\star_1\in(0,\varepsilon_1\gamma_1)$ such that 
\[
\begin{cases}
    \pderiv{\widetilde f}{\eta}(\eta)^\top P_0 +  P_0 \pderiv{\widetilde f}{\eta}(\eta) \prec 2\overbar \mu_0 P_0,\\
     \pderiv{\widetilde f}{\eta}(\eta)^\top P_1 +  P_1 \pderiv{\widetilde f}{\eta}(\eta) \prec 2\overbar \mu_1 P_1,
\end{cases}
\]
with $ \overbar \mu_0 = \mu_0+\frac{\gamma_0}2, \overbar \mu_1 = \mu_1+\frac{\gamma_1}2$. Let such upperbounds on $\gamma_0,\gamma_1$ be denoted by $\overbar \gamma_0, \overbar \gamma_1$. Since $\mu_0+\mu_1<0$, by continuity there exists $\overbar \gamma>0$ such that  $\mu_0+\mu_1+\overbar \gamma<0$. By selecting $ \gamma_0=\gamma_1 = \min(\overbar \gamma_0, \overbar \gamma_1, \overbar \gamma)$ and  $\Delta^\star < \min(\varepsilon_0 \gamma, \varepsilon_1  \gamma)$ we obtain 
\[
\begin{cases}
    \pderiv{\widetilde f}{\eta}(\eta)^\top P_0 +  P_0 \pderiv{\widetilde f}{\eta}(\eta) \prec 2\overbar \mu_0 P_0,\\
     \pderiv{\widetilde f}{\eta}(\eta)^\top P_1 +  P_1 \pderiv{\widetilde f}{\eta}(\eta) \prec 2\overbar \mu_1 P_1,\\
     \overbar \mu_0 + \overbar \mu_1<0.
\end{cases}
\]
Consequently, \citep[Theorem 5]{cecilia2023generalized} proves 2-contractivity of the closed loop \eqref{eqn:nonlin_sys_closed_loop_pert} and \citep[Theorem 2.5]{Michael1995} paired with boundedness and forward- invariance of $\cK$ guarantees the trajectories of \eqref{eqn:nonlin_sys_closed_loop} converge to a (possibly nonunique) equilibrium point. The result is proven by noting that all equilibria of \eqref{eqn:nonlin_sys_closed_loop_pert} satisfy $0=\smallpmat{KC &H& L}\eta + KG \phi(\bE \eta)=u$. 

\subsection{Proof of Proposition~\ref{prp:invariant_set}} \label{sec:proof_prp2}
% If \eqref{eqn:nonincremental_abstraction} holds, \eqref{eqn:ellipsoid_LMI} and $\gamma>0$ imply
% \[
%     \pmx{\tau P_\cE+ \bA^\top P_\cE + P_\cE \bA  & P_\cE \bB  & 0\\\bB^\top P_\cE  & 0 &0\\
%     0 & 0 & -\tau \lambda}\preceq 0.
% \]
% Therefore, left and right multiplication by the vector $\nu=\col(\eta,\phi(\bE\eta),1)$ and its transpose paired with the dynamics \eqref{eqn:nonlin_sys_closed_loop}  yields
% \[
% \dot \eta^\top P_\cE \eta + \eta^\top P_\cE \dot \eta +\tau (\eta^\top P_\cE\eta-\lambda)\le 0.
% \]
% On the boundary of $\cE$ we have $\eta^\top P_\cE\eta = \lambda$, thus implying 
% \[
% \dot \eta^\top P_\cE \eta + \eta^\top P_\cE \dot \eta\le 0.
% \]
% Consider the function $V(\eta)=\eta^\top P_\cE \eta$.  Given the above inequality, we have $\dot V(\eta) = 0$  for all $\eta\in \partial\cE$ where $\partial\cE  =\{\eta\in\RR^{n_\eta}:V(\eta)=\eta^\top P_\cE\eta =\lambda\}$. Therefore, all trajectories starting in $\cE$ remain in $\cE$, thus proving forward-invariance.

{
\label{sec:proof_prp2}
Let $\widetilde \eta \defeq \eta-\eta^\star$, $\widetilde \phi \defeq \phi(\bE\eta)-\phi(\bE\eta^\star)$ and $\widetilde \psi \defeq \psi(\bE\eta)-\psi(\bE\eta^\star) = \bD\widetilde \phi + \widetilde \bA\widetilde \eta $.
According to the dynamics \eqref{eqn:nonlin_sys_closed_loop} and the relation $\bA=\bA_s+\widetilde\bA$, we have
\[
\dot{\widetilde\eta} = \bA_s\widetilde \eta +\widetilde \psi.
\]
If \eqref{eqn:local_sect_eta_reshaped} holds for all $\eta\in\cS$, right and left multiplication of \eqref{eqn:ellipsoid_LMI} by $\nu=\col(\widetilde \eta,\widetilde\psi)$ and its transpose implies
\[
    \nu^\top\pmx{\tau_1 P_{\cE_1}-\tau_2 P_{\cE_2}+ \He{P_{\cE_1} \bA}  & P_{\cE_1}   & 0\\P_{\cE_1}  & 0 &0\\
    0 & 0 & -\tau_1+\tau_2 }\nu\prec 0.
\]
By expanding the product, we have
\begin{multline*} 
\He{\widetilde \eta^\top  P_{\cE_1} \left(\bA_s\widetilde \eta +  \widetilde\psi\right)}  \\+\tau_1 (\widetilde\eta^\top P_{\cE_1}\widetilde\eta-1) + \tau_2 (1-\widetilde\eta^\top P_{\cE_2}\widetilde\eta)< 0.
\end{multline*}
Therefore,  by \eqref{eqn:nonlin_sys_closed_loop} we have 
\begin{equation*}
    \He{\dot {\widetilde \eta}^\top P_{\cE_1} \widetilde \eta} +\tau_1 (\eta^\top P_{\cE_1}\eta-1)- \tau_2 (\eta^\top P_{\cE_2}\eta-1) \le 0,
\end{equation*}
for all $\eta\in\cS$.
Since $\tau_1,\tau_2$ are positive, if $\cE_2\subseteq\cS$
the above inequality implies
\begin{equation}\label{eqn:lyap_set_decrease}
    \dot {\widetilde \eta}^\top P_{\cE_1}\widetilde \eta + \widetilde\eta^\top P_{\cE_1} \dot {\widetilde \eta}< 0,
\end{equation}
for all $\eta\in \widetilde\cE$. 
Note that the constraint $ P_{\cE_1}\succeq  P_{\cE_2}$ ensures $\widetilde\cE$ is not empty. Indeed, it implies 
\[\widetilde\eta^\top  P_{\cE_1}\widetilde\eta \ge \widetilde\eta^\top  P_{\cE_2}\widetilde\eta 
\]
and therefore 
$\cE_1\subseteq \cE_2$.
Consequently, $\widetilde\cE$ contains at least the boundary of $\cE_1$ and thus it is not empty.

Consider now the function $V(\eta)=\widetilde\eta^\top P_{\cE_1} \widetilde\eta$.  Given \eqref{eqn:lyap_set_decrease}, for all $\eta \in \widetilde\cE$ we have $\dot V(\eta) < 0$. Therefore, all trajectories starting in $\widetilde\cE$ converge to $\cE_1$, thus proving its attractiveness and forward-invariance.}

\subsection{Proof of Lemma~\ref{lem:orig2reshaped_abs}} \label{sec:proof_lem1}
If \eqref{eqn:D_full} holds, a Schur complement on the bottom-right entry provides
\[
\bD^\top \Omega +\Omega^\top \bD -\Omega^\top\Omega\succ 0.
\]
By adding and subtracting $\bD^\top \bD$, we obtain
\[
\bD^\top \bD\succ (\Omega-\bD)^\top(\Omega-\bD).
\]
Therefore, since $(\Omega-\bD)^\top(\Omega-\bD)\succeq 0$, $\bD^\top \bD\succ 0$. Let $\widetilde \eta \defeq \eta-\eta^\star$, $\widetilde \phi \defeq \phi(\bE\eta)-\phi(\bE\eta^\star)$ and $\widetilde \psi \defeq \psi(\bE\eta)-\psi(\bE\eta^\star) = \bD\widetilde \phi + \widetilde \bA\widetilde \eta $. Since $\bD^\top \bD$ is invertible, we have
\begin{align*}
    \bD^\top \widetilde \psi &= \bD^\top \bD \widetilde \phi + \bD^\top \widetilde \bA \widetilde \eta\\
      (\bD^\top \bD)^{-1}\bD^\top(\widetilde \psi - \widetilde \bA \widetilde \eta) &= \widetilde \phi \\
     \overbar \bD(\widetilde \psi - \widetilde \bA \widetilde \eta) &= \widetilde \phi 
\end{align*}
If \eqref{eqn:local_sect_eta} holds, the result is proven by substituting the above relation in \eqref{eqn:local_sect_eta} and collecting the terms in $\widetilde \eta$ and $\widetilde \psi$. 



\subsection{Proof of Lemma~\ref{lem:diff2incr_abstraction}} \label{sec:proof_lem2}
Left and right multiplication of \eqref{eqn:diff_abstr} by $\widetilde v \defeq v_1-v_2$ and expansion of the product yields
\[
\widetilde v^\top R_v\widetilde v + 2 \widetilde v^\top S_v^\top \pderiv{\phi}{v}(v)\widetilde v +\widetilde v^\top \pderiv{\phi}{v}(v)^\top Q_v \pderiv{\phi}{v}(v)\widetilde v \le 0.
\]
Since $Q\succ 0$, by Schur complement we obtain
\begin{equation}\label{eqn:diff2incre_abs}
\pmx{\widetilde v^\top R_v\widetilde v + 2 \widetilde v^\top S_v^\top \pderiv{\phi}{v}(v)\widetilde v && \widetilde v^\top \pderiv{\phi}{v}(v)^\top\\  \pderiv{\phi}{v}(v)\widetilde v && -Q_v^{-1}} \preceq 0,
\end{equation}
for all $v,\widetilde v \in \RR^{n_v}$.
Consider now the function $F:[0,1]\to\RR^{n_v}$ defined as
\[
F(s) \defeq \phi(v_2+s(v_1-v_2)) = \phi(v_2+s\widetilde v).
\]
By the fundamental theorem of calculus, we have
\[
F(1)-F(0)=\phi(v_1)-\phi(v_2) = \int_0^1 \pderiv{\phi}{s}(v_2+s\widetilde v)\, ds \, \widetilde v.
\]
Since \eqref{eqn:diff2incre_abs} holds for all $v\in \RR^{n_v}$, selecting $v = v_2-s\widetilde v$ and integrating over $s$ yields
\[
\pmx{\widetilde v^\top R_v\widetilde v + 2 \widetilde v^\top S_v^\top (\phi(v_1)-\phi(v_2)) &&  (\phi(v_1)-\phi(v_2))^\top\\   (\phi(v_1)-\phi(v_2)) && -Q_v^{-1}} \preceq 0.
\]
The proof is concluded with by Schur complement on the bottom-right entry of the above matrix and by collecting the vectors $\col(\widetilde v, \phi(v_1)-\phi(v_2)) $ and its transpose.

\subsection{Proof of Theorem~\ref{thm:invariant_ellipsoid_local_sect}}\label{sec:proof_thm1}
By Proposition~\ref{prp:invariant_set}, the result is proven if \eqref{eqn:local_sector_v}, \eqref{eqn:D_full} and \eqref{eqn:local_sector_and_inclusion} imply the local abstraction \eqref{eqn:local_sect_eta_reshaped} for $\eta^\star=\col(x^\star, 0, 0)$ and $\cE_2\subseteq \cS$ with $\cS\defeq\{\eta\in\RR^{n_\eta}: \bE\eta\in[\underline v,\overbar v]\}$. Consider \eqref{eqn:local_sector_v} first and define $\widetilde v = v-v^\star = E(x-x^\star)=E\widetilde x$ and $\widetilde \phi = \phi(v)-\phi(v^\star)$. By \citep[Lemma 2]{de2023event}, inequality \eqref{eqn:local_sector_v} implies 
\begin{equation}
    \label{eqn:incremental_abs_v_Pi}
    \pmx{\widetilde v\\\widetilde \phi}^\top\pmx{X_v&Y_v^\top\\Y_v&Z_v}\pmx{\widetilde v\\\widetilde \phi}\le 0
\end{equation}
for all $v\in[\underline v,\overbar v]$ and all $X_v,Y_v,Z_v$ such that \eqref{eqn:local_sec_open_loop_polytopic} holds.
Since $\widetilde v=\bE\widetilde \eta$ and $\widetilde \phi = \phi(\bE\eta)-\phi(\bE\eta^\star)$, \eqref{eqn:incremental_abs_v_Pi} implies
\begin{equation}
    \label{eqn:incremental_abs_eta_Pi}
    \pmx{\widetilde \eta\\\widetilde \phi}^\top\pmx{\bE^\top X_v \bE &\bE^\top Y_v^\top\\Y_v\bE &Z_v}\pmx{\widetilde \eta\\\widetilde \phi}\le 0
\end{equation}
for all $\eta\in\cS$ and all $X_v,Y_v,Z_v$ such that \eqref{eqn:local_sec_open_loop_polytopic} holds. Therefore, by Lemma~\ref{lem:orig2reshaped_abs} with $X=\bE^\top X_v \bE$, $Y=Y_v\bE$ and $Z = Z_v$
we have 
\begin{equation}
    \label{eqn:local_sect_eta_reshaped_hat}
    \pmx{\eta - \eta^\star\\ \psi(\bE\eta)-\psi(\bE\eta^\star)}^\top\pmx{\widehat X &\widehat Y^\top\\\widehat Y& \widehat Z}\pmx{\eta - \eta^\star\\ \psi(\bE\eta)-\psi(\bE\eta^\star)}\le 0,
\end{equation}
for all $\eta\in\cS$. 
Consider now \eqref{eqn:local_sec_closed_loop_polytopic}. Right and left multiplication  of  by $\nu = \col(\dot{\widetilde \eta}, \widetilde \eta, \widetilde \psi)$ and its transpose 
yields
\[
\pmx{\widetilde \eta\\\widetilde \psi}^\top\pmx{\bX & \bY^\top\\\bY&\bZ}\pmx{\widetilde \eta\\\widetilde \psi}\le \pmx{\widetilde \eta\\\widetilde \psi}^\top\pmx{\widehat X & \widehat Y^\top\\\widehat Y&\widehat Z}\pmx{\widetilde \eta\\\widetilde \psi}\le 0,
\]
for all $\eta\in\cS$. 
Therefore, \eqref{eqn:incremental_abs_v_Pi} implies the local abstraction \eqref{eqn:local_sect_eta_reshaped} holds for all $\eta\in\cS$. 

Consider now \eqref{eqn:ellipsoid_inclusion_polytopic}.
Note that $\eta\in\cS$ if $|\bE\eta-\bE\eta^\star|_i \le |\overline v -\underline v|_i$ for all vector entries $i=1,\dots,n_v$. A Schur complement on the bottom-right block of \eqref{eqn:ellipsoid_inclusion_polytopic} yields
\[
P_{\cE_2}\succeq \frac{1}{(\overbar v -\underline v)_i^\top  (\overbar v -\underline v)_i}\bE_i^\top \bE_i
\]
and in turn
\[
\widetilde \eta^\top P_{\cE_2} \widetilde \eta^\top\ge \frac{1}{(\overbar v -\underline v)^\top  (\overbar v -\underline v)} \widetilde \eta^\top\bE_i^\top \bE_i\widetilde \eta^\top.
\]
 Consequently, if $\eta\in\cE_2$, 
 \[
(\overbar v -\underline v)_i^\top  (\overbar v -\underline v)_i \ge \widetilde \eta^\top\bE_i^\top \bE_i\widetilde \eta^\top
\]
and thus $\eta\in\cS$. Therefore $\cE_2\subseteq \cS$ and this concludes the proof.
\section{Conclusions}
Future work will also explore discrete-time extensions, building on the recent studies \citep{zoboli2024k}.

\bibliography{Bibliography/first}


\end{document}
